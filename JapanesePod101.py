from bs4 import BeautifulSoup
import urllib2
import MySQLdb
from MySQLConnectionHandler import MySQLConnectionHandler


BASE_URL = "https://www.japanesepod101.com"

path = ["/japanese-vocabulary-lists/trains", "/japanese-vocabulary-lists/technology", "/japanese-vocabulary-lists/workplace", "/japanese-vocabulary-lists/talking-about-months", "/japanese-vocabulary-lists/10-funny-and-strange-japanese-expressions", "/japanese-vocabulary-lists/10-lines-you-need-for-introducing-yourself", "/japanese-vocabulary-lists/10-phrases-you-never-want-to-hear", "/japanese-vocabulary-lists/10-words-and-phrases-youll-need-for-the-academy-awards", "/japanese-vocabulary-lists/12-days-of-christmas", "/japanese-vocabulary-lists/12-phrases-you-can-use-on-april-fools-day", "/japanese-vocabulary-lists/13-ways-to-study-japanese-for-free-with-japanesepod101", "/japanese-vocabulary-lists/15-love-phrases-for-valentines-day", "/japanese-vocabulary-lists/15-most-common-break-up-lines", "/japanese-vocabulary-lists/15-shopping-phrases-exchanges-refunds-and-complaints", "/japanese-vocabulary-lists/15-ways-to-study-japanese-for-free-with-japanesepod101", "/japanese-vocabulary-lists/15-words-and-phrases-youll-need-for-black-history-month", "/japanese-vocabulary-lists/17-untranslatable-words-from-around-the-world", "/japanese-vocabulary-lists/20-common-words-for-occupations", "/japanese-vocabulary-lists/20-words-youll-need-for-the-beach", "/japanese-vocabulary-lists/anime-fighting-expression", "/japanese-vocabulary-lists/armed-forces-day-in-the-united-states", "/japanese-vocabulary-lists/at-the-movies", "/japanese-vocabulary-lists/at-the-office", "/japanese-vocabulary-lists/japan-autumnal-equinox-day", "/japanese-vocabulary-lists/back-to-school-essentials", "/japanese-vocabulary-lists/bean-throwing-ceremony", "/japanese-vocabulary-lists/birthday-of-martin-luther-king-jr", "/japanese-vocabulary-lists/body-parts", "/japanese-vocabulary-lists/japan-bon-festival", "/japanese-vocabulary-lists/bugs", "/japanese-vocabulary-lists/buildings", "/japanese-vocabulary-lists/japan-year-end-party", "/japanese-vocabulary-lists/can-you-identify-these-japanese-foods", "/japanese-vocabulary-lists/can-you-name-the-top-10-travel-spots-in-japan", "/japanese-vocabulary-lists/can-you-guess-these-languages", "/japanese-vocabulary-lists/japan-celebration-for-7-5-3-year-olds", "/japanese-vocabulary-lists/childrens-day", "/japanese-vocabulary-lists/clothes", "/japanese-vocabulary-lists/clothing-accessories", "/japanese-vocabulary-lists/columbus-day", "/japanese-vocabulary-lists/coming-of-age-day", "/japanese-vocabulary-lists/common-health-problems", "/japanese-vocabulary-lists/common-kanji-1-nouns-made-up-of-two-kanji", "/japanese-vocabulary-lists/common-kanji-2-basic-kanji-for-verbs", "/japanese-vocabulary-lists/common-kanji-3-basic-kanji-for-adjectives", "/japanese-vocabulary-lists/common-kanji-4-kanji-for-days-of-the-week", "/japanese-vocabulary-lists/common-kanji-5-kanji-for-direction-and-position", "/japanese-vocabulary-lists/common-kanji-6-kanji-for-numbers-and-counters", "/japanese-vocabulary-lists/common-kanji-7-one-kanji-nouns", "/japanese-vocabulary-lists/common-phrases-youll-need-for-a-date", "/japanese-vocabulary-lists/common-phrases-to-know-about-having-a-baby", "/japanese-vocabulary-lists/common-ways-to-say-hello", "/japanese-vocabulary-lists/common-ways-to-say-sorry", "/japanese-vocabulary-lists/common-ways-to-say-thank-you", "/japanese-vocabulary-lists/cooking", "/japanese-vocabulary-lists/culture-day", "/japanese-vocabulary-lists/daily-life-related-actions", "/japanese-vocabulary-lists/difficult-katakana-words-to-say", "/japanese-vocabulary-lists/difficult-words-to-say", "/japanese-vocabulary-lists/direction-words", "/japanese-vocabulary-lists/disasters", "/japanese-vocabulary-lists/do-you-know-the-essential-summer-vocabulary", "/japanese-vocabulary-lists/do-you-know-how-to-use-japanese-honorifics", "/japanese-vocabulary-lists/do-you-know-these-beginner-japanese-words-and-phrases", "/japanese-vocabulary-lists/dolls-festival", "/japanese-vocabulary-lists/dont-travel-without-knowing-these-top-10-verbs", "/japanese-vocabulary-lists/easter", "/japanese-vocabulary-lists/election-day-in-the-united-states", "/japanese-vocabulary-lists/end-of-the-year-cleaning-day", "/japanese-vocabulary-lists/falling-in-love", "/japanese-vocabulary-lists/fathers-day", "/japanese-vocabulary-lists/feeling-happy-learn-the-top-20-words-for-positive-emotions", "/japanese-vocabulary-lists/feeling-sad-learn-the-top-21-words-for-negative-emotions", "/japanese-vocabulary-lists/flag-day-in-the-united-states", "/japanese-vocabulary-lists/four-character-japanese-idiom-yojijukugo", "/japanese-vocabulary-lists/four-character-japanese-idiom-yojijukugo-2", "/japanese-vocabulary-lists/four-character-japanese-idiom-yojijukugo-3", "/japanese-vocabulary-lists/four-character-japanese-idiom-yojijukugo-4", "/japanese-vocabulary-lists/four-character-japanese-idiom-yojijukugo-5", "/japanese-vocabulary-lists/fourth-of-july-in-the-united-states", "/japanese-vocabulary-lists/fruits", "/japanese-vocabulary-lists/get-ready-for-the-super-bowl", "/japanese-vocabulary-lists/getting-started-with-quizzes", "/japanese-vocabulary-lists/golden-week", "/japanese-vocabulary-lists/green-vocabulary-for-earth-day", "/japanese-vocabulary-lists/hanabi-the-japanese-fireworks-festival", "/japanese-vocabulary-lists/japan-cherry-blossom-viewing-season", "/japanese-vocabulary-lists/happy-new-year-words-phrases-for-the-new-year", "/japanese-vocabulary-lists/japan-health-sports-day", "/japanese-vocabulary-lists/hobbies", "/japanese-vocabulary-lists/holiday-greetings-and-wishes-for-the-holiday-season", "/japanese-vocabulary-lists/how-do-you-motivate-yourself-when-learning-a-language", "/japanese-vocabulary-lists/how-do-you-remember-words", "/japanese-vocabulary-lists/how-japanese-are-you", "/japanese-vocabulary-lists/how-well-do-you-know-japanese-pop-culture", "/japanese-vocabulary-lists/how-well-do-you-speak-japanese", "/japanese-vocabulary-lists/how-will-you-spend-your-summer-vacation", "/japanese-vocabulary-lists/how-will-you-spend-your-winter-holiday", "/japanese-vocabulary-lists/how-to-ask-how-are-you-and-answer-it", "/japanese-vocabulary-lists/how-to-introduce-yourself-in-different-languages", "/japanese-vocabulary-lists/in-your-toolbox", "/japanese-vocabulary-lists/in-the-classroom", "/japanese-vocabulary-lists/in-your-wallet", "/japanese-vocabulary-lists/international-talk-like-a-pirate-day", "/japanese-vocabulary-lists/japanese-actors", "/japanese-vocabulary-lists/japanese-ice-cream-words-phrases", "/japanese-vocabulary-lists/japan-school-festival-season", "/japanese-vocabulary-lists/japanese-superstitions", "/japanese-vocabulary-lists/japanese-vocabulary-for-rainy-season-survival-in-japan", "/japanese-vocabulary-lists/japanese-wordplay", "/japanese-vocabulary-lists/kanji-radical-1", "/japanese-vocabulary-lists/kanji-radical-2", "/japanese-vocabulary-lists/japanese-key-phrase-list", "/japanese-vocabulary-lists/labor-day-in-the-united-states", "/japanese-vocabulary-lists/labor-thanksgiving-day", "/japanese-vocabulary-lists/learn-japanese-with-10-fun-anime", "/japanese-vocabulary-lists/learn-the-top-15-weather-conditions", "/japanese-vocabulary-lists/learn-the-top-25-must-know-japanese-phrases", "/japanese-vocabulary-lists/major-cities", "/japanese-vocabulary-lists/making-complaints", "/japanese-vocabulary-lists/making-a-compliment", "/japanese-vocabulary-lists/march-madness-basketball", "/japanese-vocabulary-lists/marriage-proposal-lines", "/japanese-vocabulary-lists/memorial-day-in-the-united-states", "/japanese-vocabulary-lists/mothers-day", "/japanese-vocabulary-lists/mountain-day", "/japanese-vocabulary-lists/musical-instruments", "/japanese-vocabulary-lists/must-know-adverbs-and-phrases-for-connecting-thoughts", "/japanese-vocabulary-lists/must-know-christmas-day-vocabulary", "/japanese-vocabulary-lists/must-know-terms-for-family-members", "/japanese-vocabulary-lists/must-know-valentines-day-vocabulary", "/japanese-vocabulary-lists/must-know-words-phrases-for-oktoberfest", "/japanese-vocabulary-lists/must-know-words-phrases-youll-need-to-go-camping", "/japanese-vocabulary-lists/must-know-words-phrases-to-use-at-an-amusement-park", "/japanese-vocabulary-lists/must-know-words-and-phrases-for-playing-pokemon-go", "/japanese-vocabulary-lists/must-know-autumn-vocabulary", "/japanese-vocabulary-lists/must-know-expressions-for-agreeing-and-disagreeing", "/japanese-vocabulary-lists/must-know-math-words-and-phrases", "/japanese-vocabulary-lists/must-know-phrases-for-game-of-thrones-season-7", "/japanese-vocabulary-lists/national-foundation-day", "/japanese-vocabulary-lists/new-years-list", "/japanese-vocabulary-lists/news-words", "/japanese-vocabulary-lists/numbers", "/japanese-vocabulary-lists/nygakushiki-the-japanese-school-entrance-ceremony", "/japanese-vocabulary-lists/on-a-plane", "/japanese-vocabulary-lists/japanese-opposite-words", "/japanese-vocabulary-lists/phrases-to-use-with-your-premium-plus-teacher", "/japanese-vocabulary-lists/phrases-you-need-at-the-bus-or-train-station", "/japanese-vocabulary-lists/phrases-your-parents-always-say", "/japanese-vocabulary-lists/phrases-to-use-when-youre-angry", "/japanese-vocabulary-lists/places", "/japanese-vocabulary-lists/position-direction", "/japanese-vocabulary-lists/quotes-about-love", "/japanese-vocabulary-lists/japan-respect-for-the-aged-day", "/japanese-vocabulary-lists/school", "/japanese-vocabulary-lists/showa-day", "/japanese-vocabulary-lists/sotsugyshiki-the-japanese-graduation-ceremony", "/japanese-vocabulary-lists/sounds-that-animals-make", "/japanese-vocabulary-lists/spring-activities", "/japanese-vocabulary-lists/spring-adjectivesadverbs", "/japanese-vocabulary-lists/spring-verbs", "/japanese-vocabulary-lists/st-patricks-day", "/japanese-vocabulary-lists/japan-star-festival", "/japanese-vocabulary-lists/studying-onomatopoeia", "/japanese-vocabulary-lists/summer-clothes-and-accessories", "/japanese-vocabulary-lists/top-10-must-know-survival-words-phrases-for-your-next-trip-to-japan", "/japanese-vocabulary-lists/survive-the-zombie-apocalypse-with-these-top-20-words-and-phrases", "/japanese-vocabulary-lists/take-a-bite-out-of-these-shark-week-words", "/japanese-vocabulary-lists/talking-about-colors", "/japanese-vocabulary-lists/talking-about-days", "/japanese-vocabulary-lists/talking-about-months", "/japanese-vocabulary-lists/talking-about-time", "/japanese-vocabulary-lists/technology", "/japanese-vocabulary-lists/thanksgiving-day-in-the-united-states", "/japanese-vocabulary-lists/the-10-most-romantic-ideas-for-a-date", "/japanese-vocabulary-lists/the-50-most-common-japanese-verbs-youll-find-in-textbooks", "/japanese-vocabulary-lists/the-baseball-words-youll-need-for-the-world-series", "/japanese-vocabulary-lists/the-emperors-birthday", "/japanese-vocabulary-lists/star-wars-day", "/japanese-vocabulary-lists/the-top-10-ways-to-prepare-for-travel", "/japanese-vocabulary-lists/the-top-one-million-words-you-need-to-know-for-april-fools-day", "/japanese-vocabulary-lists/the-weather", "/japanese-vocabulary-lists/things-your-body-does", "/japanese-vocabulary-lists/tongue-twisters-in-different-languages", "/japanese-vocabulary-lists/too-cool-for-school-top-15-phrases-for-bad-students", "/japanese-vocabulary-lists/top-7-lists-youll-need-to-improve-your-language-skills", "/japanese-vocabulary-lists/top-10-christmas-characters-in-american-culture", "/japanese-vocabulary-lists/top-10-conversational-phrases", "/japanese-vocabulary-lists/top-10-free-japanese-lessons-you-can%e2%80%99t-miss", "/japanese-vocabulary-lists/top-10-foods-that-will-kill-you-faster", "/japanese-vocabulary-lists/top-10-foods-that-will-make-you-live-longer", "/japanese-vocabulary-lists/top-10-hardest-words-to-pronounce", "/japanese-vocabulary-lists/top-10-inspirational-quotes", "/japanese-vocabulary-lists/top-10-japanese-anime", "/japanese-vocabulary-lists/top-10-japanese-musicians-and-musical-groups-chosen-by-our-facebook-us", "/japanese-vocabulary-lists/top-10-language-learning-strategies", "/japanese-vocabulary-lists/top-10-most-hated-foods-chosen-by-facebook-users", "/japanese-vocabulary-lists/top-10-new-years-resolutions", "/japanese-vocabulary-lists/top-10-phrases-that-make-you-look-like-a-fool", "/japanese-vocabulary-lists/top-10-phrases-you-always-want-to-hear", "/japanese-vocabulary-lists/top-10-phrases-to-amaze-native-speakers", "/japanese-vocabulary-lists/top-10-quotes-about-language-learning", "/japanese-vocabulary-lists/top-10-quotes-about-family", "/japanese-vocabulary-lists/top-10-quotes-about-friendship", "/japanese-vocabulary-lists/top-10-sentence-patterns-for-beginners", "/japanese-vocabulary-lists/top-10-travel-spots-in-japan", "/japanese-vocabulary-lists/weekend-activities", "/japanese-vocabulary-lists/top-11-quotes-about-success", "/japanese-vocabulary-lists/top-15-compliments-you-always-want-to-hear", "/japanese-vocabulary-lists/favorite-words", "/japanese-vocabulary-lists/top-15-questions-you-should-know-for-conversations", "/japanese-vocabulary-lists/top-15-things-to-do-over-spring-break", "/japanese-vocabulary-lists/top-20-words-youll-need-for-the-internet", "/japanese-vocabulary-lists/top-25-words-to-know-for-the-comic-con", "/japanese-vocabulary-lists/top-30-anime-words-phrases", "/japanese-vocabulary-lists/top-30-travel-phrases-you-should-know", "/japanese-vocabulary-lists/top-38-languages-spoken-in-the-world", "/japanese-vocabulary-lists/tourist-attractions", "/japanese-vocabulary-lists/track-and-field", "/japanese-vocabulary-lists/trains", "/japanese-vocabulary-lists/rainy-season", "/japanese-vocabulary-lists/japan-typhoon-season", "/japanese-vocabulary-lists/veterans-day-in-the-united-states", "/japanese-vocabulary-lists/vocabulary-and-phrases-for-the-restaurant", "/japanese-vocabulary-lists/washingtons-birthday", "/japanese-vocabulary-lists/what-are-the-top-10-summer-sports", "/japanese-vocabulary-lists/what-gift-do-you-want-the-most-this-holiday-season", "/japanese-vocabulary-lists/what-is-your-language-learning-goal-for-the-month", "/japanese-vocabulary-lists/what-was-the-first-phrase-you-learned", "/japanese-vocabulary-lists/us-halloween", "/japanese-vocabulary-lists/what-are-the-top-10-japanese-movies", "/japanese-vocabulary-lists/what-are-the-top-japanese-drinks", "/japanese-vocabulary-lists/whats-your-favorite-food", "/japanese-vocabulary-lists/whats-your-favorite-way-to-learn-a-language", "/japanese-vocabulary-lists/whats-your-number-one-reason-for-learning", "/japanese-vocabulary-lists/whats-the-adjective-that-describes-your-personality-the-best", "/japanese-vocabulary-lists/which-jlpt-level-would-you-pass", "/japanese-vocabulary-lists/which-language-would-you-like-to-learn-with-innovativelanguagecom", "/japanese-vocabulary-lists/japan-white-day", "/japanese-vocabulary-lists/winter", "/japanese-vocabulary-lists/winter-clothes", "/japanese-vocabulary-lists/olympics", "/japanese-vocabulary-lists/word-phrase-list-for-007-james-bond-spectre", "/japanese-vocabulary-lists/word-phrase-list-for-avengers-age-of-ultron", "/japanese-vocabulary-lists/word-phrase-list-for-dancing-with-the-stars", "/japanese-vocabulary-lists/word-phrase-list-for-downton-abbey", "/japanese-vocabulary-lists/word-phrase-list-for-furious-7", "/japanese-vocabulary-lists/word-phrase-list-for-jurassic-world", "/japanese-vocabulary-lists/word-phrase-list-for-mad-max", "/japanese-vocabulary-lists/word-phrase-list-for-mission-impossible-5", "/japanese-vocabulary-lists/word-phrase-list-for-the-hunger-games-mockingjay-part-2", "/japanese-vocabulary-lists/word-phrase-list-for-the-apple-keynote-event", "/japanese-vocabulary-lists/words-phrases-for-fantastic-beasts-and-where-to-find-them", "/japanese-vocabulary-lists/words-for-winter-snow-days", "/japanese-vocabulary-lists/words-and-phrases-for-enjoying-the-2016-summer-olympics", "/japanese-vocabulary-lists/words-and-phrases-for-enjoying-the-cannes-film-festival", "/japanese-vocabulary-lists/words-and-phrases-to-get-you-through-friday-the-13th", "/japanese-vocabulary-lists/words-and-phrases-to-help-you-describe-your-feelings", "/japanese-vocabulary-lists/words-and-phrases-to-help-you-in-an-emergency", "/japanese-vocabulary-lists/words-and-phrases-to-wake-you-up-for-international-coffee-day", "/japanese-vocabulary-lists/words-for-the-first-day-of-spring", "/japanese-vocabulary-lists/words-to-know-for-presidents-day-in-the-united-states", "/japanese-vocabulary-lists/words-to-know-for-the-mtv-video-music-awards", "/japanese-vocabulary-lists/workplace", "/japanese-vocabulary-lists/world-cup-soccer", "/japanese-vocabulary-lists/world-cup-2014", "/japanese-vocabulary-lists/world-television-day"] 

print len(path)
mysqlConnector = MySQLConnectionHandler()
db = mysqlConnector.getDatabase()
cursor = mysqlConnector.getCursor()

def get_soup(url):
    return BeautifulSoup(urllib2.urlopen(urllib2.Request(url)),'html.parser')

for category in path:
    url = BASE_URL + category
    print url
    soup = get_soup(url)
    hiragana = []
    english = []
    romaji = []
    kanji = []
    exampleJapanese = []
    exampleEnglish = []

    for a in soup.find_all("span",{"class":"wlv-item__word-field js-wlv-word-field js-wlv-word-field-kana kana"}):
        hiragana.append(a.text)
    for a in soup.find_all("span",{"class":"wlv-item__english js-wlv-english"}):
        english.append(a.text)
    for a in soup.find_all("span",{"class":"wlv-item__word-field js-wlv-word-field js-wlv-word-field-romaji romaji"}):
        romaji.append(a.text)
    for a in soup.find_all("span",{"class":"wlv-item__word-field js-wlv-word-field kana"}):
        exampleJapanese.append(a.text)
    for a in soup.find_all(lambda tag: tag.name == "span" and tag.get('class') == ["wlv-item__english"]):
        exampleEnglish.append(a.text)
    for a in soup.find_all("span", {"class": "wlv-item__word-zoom js-wlv-word-zoom"}):
        kanji.append(a.text)

    print category[27:]
    print len(hiragana)
    print len(english)
    print len(romaji)
    print len(kanji)
    print len(exampleEnglish)
    print len(exampleJapanese)

    diff = len(hiragana) - len(exampleJapanese)
    for i in range(diff):
        exampleJapanese.append("")
    diff = len(hiragana) - len(exampleEnglish)
    for i in range(diff):
        exampleEnglish.append("")
    for i in range(len(hiragana)):

        sql = "INSERT INTO vocabulary(word, \
               hiragana, kanji, romaji, category, exampleEnglish, exampleJapanese) \
               VALUES ('%s', '%s', '%s', '%s', '%s', '%s', '%s')" % \
               (english[i].strip(), hiragana[i].strip(), kanji[i].strip(), romaji[i].strip(), category[27:].strip().replace("-", " "), exampleEnglish[i].strip(), exampleJapanese[i].strip())
        try:
           # Execute the SQL command
           x = cursor.execute(sql)
           # Commit your changes in the database
           db.commit()
           print "success"
        except:
           # Rollback in case there is any error
           db.rollback()
           print "failed "
           print english[i].strip(), hiragana[i].strip(), kanji[i].strip(), romaji[i].strip(), category.strip().replace("-", " "), exampleEnglish[i].strip(), exampleJapanese[i].strip()

# disconnect from server
db.close()
